<!DOCTYPE html>
<html>

<head>
    <title>คำนวณค่าเฉลี่ยของข้อมูลความสูง</title>
</head>

<body>
    <h1>คำนวณค่าเฉลี่ยของข้อมูลความสูง</h1>
    <label for="rowInput">Number of Rows: </label>
    <input type="number" id="rowInput" />
    <button onclick="generateTable()">Generate Table</button>

    <table border="1" id="data-table">
        <tr>
            <th>ความสูง1</th>
            <th>ความสูง2</th>
            <th>จำนวน</th>
            <th>จุดกึ่งกลางชั้น</th>
            <th>fi</th>
            <th>fixi</th>
        </tr>
    </table>

    <p>ค่าเฉลี่ย: <span id="averageValue"></span></p>

    <script>
        function calculateRow(row) {
            const height1 = parseFloat(row.querySelector(".height:first-child").value);
            const height2 = parseFloat(row.querySelector(".height:last-child").value);
            const count = parseInt(row.querySelector(".count").value);
            const fixi = (height1 + height2) / 2;
            const fi = count;
            const fiFixi = fixi * fi;

            row.querySelector(".fixi").textContent = fixi;
            row.querySelector(".fi").textContent = fi;
            row.querySelector(".fixiResult").textContent = fiFixi;

            updateTotal();
        }

        function updateTotal() {
            const rows = document.querySelectorAll("#data-table tr");
            let totalFi = 0;
            let totalFiFixi = 0;

            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                totalFi += parseInt(row.querySelector(".count").value);
                totalFiFixi += parseFloat(row.querySelector(".fixiResult").textContent);
            }

            const average = totalFiFixi / totalFi;
            document.getElementById("averageValue").textContent = average.toFixed(1);
        }

        function addRow() {
            const table = document.getElementById("data-table");
            const newRow = table.insertRow(table.rows.length - 1);
            newRow.innerHTML = `
        <td><input type="number" class="height" oninput="calculateRow(this.parentNode.parentNode)" /></td>
        <td><input type="number" class="height" oninput="calculateRow(this.parentNode.parentNode)" /></td>
        <td><input type="number" class="count" oninput="calculateRow(this.parentNode.parentNode)" /></td>
        <td class="fixi"></td>
        <td class="fi"></td>
        <td class="fixiResult"></td>
      `;

            updateTotal();
        }

        function generateTable() {
            const rowCount = parseInt(document.getElementById("rowInput").value);

            const table = document.getElementById("data-table");
            while (table.rows.length > 1) {
                table.deleteRow(table.rows.length - 2);
            }

            for (let i = 0; i < rowCount; i++) {
                addRow();
            }
        }
    </script>
</body>

</html>