<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Median Calculator</title>
</head>

<body>
    <h1>Median Calculator</h1>

    <label for="rowCount">Number of Rows: </label>
    <input type="number" id="rowCount" min="1" value="5">
    <button id="generateTable">Generate Table</button><br><br><br>

    <div id="tableContainer"></div>
    <div id="calculationSteps"></div>

    <script>
        document.getElementById('generateTable').addEventListener('click', generateTable);

        function generateTable() {
            const rowCount = parseInt(document.getElementById('rowCount').value);
            const tableContainer = document.getElementById('tableContainer');

            let tableHTML = `
         <table>
           <tr>
             <th>Height</th>
             <th>Number of People</th>
             <th>Cumulative Frequency</th>
           </tr>
       `;

            for (let i = 0; i < rowCount; i++) {
                tableHTML += `
           <tr>
             <td><input type="text" class="height-input" placeholder="Height"></td>
             <td><input type="number" class="num-people-input" placeholder="Number of People"></td>
             <td><span class="cumulative-freq">0</span></td>
           </tr>
         `;
            }

            tableHTML += '</table>';
            tableContainer.innerHTML = tableHTML;

            const heightInputs = document.querySelectorAll('.height-input');
            const numPeopleInputs = document.querySelectorAll('.num-people-input');

            for (let i = 0; i < rowCount; i++) {
                heightInputs[i].addEventListener('input', updateCumulativeFreq);
                numPeopleInputs[i].addEventListener('input', updateCumulativeFreq);
            }

            updateCumulativeFreq(); // Update cumulative frequency after generating table
        }

        function updateCumulativeFreq() {
            const numPeopleInputs = document.querySelectorAll('.num-people-input');
            const cumulativeFreqSpans = document.querySelectorAll('.cumulative-freq');

            let cumulativeFreq = 0;

            for (let i = 0; i < numPeopleInputs.length; i++) {
                const numPeople = parseInt(numPeopleInputs[i].value) || 0;

                cumulativeFreq += numPeople;
                cumulativeFreqSpans[i].textContent = cumulativeFreq;
            }

            calculateMedian(); // Calculate median after updating cumulative frequency
        }
        function calculateMedian() {
            const cumulativeFreqSpans = document.querySelectorAll('.cumulative-freq');
            const rowCount = cumulativeFreqSpans.length;
            const n = parseInt(cumulativeFreqSpans[rowCount - 1].textContent);

            const f = parseInt(document.querySelectorAll('.num-people-input')[rowCount - 1].value);
            const i = parseInt(document.querySelectorAll('.height-input')[rowCount - 1].value) - parseInt(document.querySelectorAll('.height-input')[rowCount - 2].value);
            const l = parseInt(document.querySelectorAll('.height-input')[rowCount - 2].value);

            const medianCalculation = `
            Me = ${l} + ${i} / ${f} * (${n} / 2 - ${cumulativeFreqSpans[rowCount - 2].textContent})
            Me = ${l} + ${i} / ${f} * ${n / 2 - parseInt(cumulativeFreqSpans[rowCount - 2].textContent)}
            Me ≈ ${l} + ${i} / ${f} * ${n / 2 - parseInt(cumulativeFreqSpans[rowCount - 2].textContent)}
            Me ≈ ${l} + ${i / f} * ${n / 2 - parseInt(cumulativeFreqSpans[rowCount - 2].textContent)}
            Me ≈ ${l} + ${i / f * (n / 2 - parseInt(cumulativeFreqSpans[rowCount - 2].textContent))}
            Me ≈ ${l + i / f * (n / 2 - parseInt(cumulativeFreqSpans[rowCount - 2].textContent))}
            `;

            document.getElementById("calculationSteps").textContent = medianCalculation;

            const me = l + (i / f) * (n / 2 - parseInt(cumulativeFreqSpans[rowCount - 2].textContent));
            document.getElementById("medianResult").textContent = `Median: ${me.toFixed(3)}`;
        }

    </script>
</body>

</html>